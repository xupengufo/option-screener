# ğŸ”§ Streamlit éƒ¨ç½²é”™è¯¯ä¿®å¤

## é—®é¢˜æè¿°

**é”™è¯¯ç±»å‹**: `UnserializableReturnValueError`

**é”™è¯¯ä¿¡æ¯**: 
```
streamlit.runtime.caching.cache_errors.UnserializableReturnValueError: 
This app has encountered an error. The original error message is redacted to prevent data leaks.
```

**æ ¹æœ¬åŸå› **: 
`@st.cache_data` è£…é¥°å™¨æ— æ³•åºåˆ—åŒ– `yfinance.Ticker` å¯¹è±¡ï¼Œå› ä¸ºè¯¥å¯¹è±¡åŒ…å«ä¸å¯åºåˆ—åŒ–çš„å†…éƒ¨çŠ¶æ€ã€‚

## è§£å†³æ–¹æ¡ˆ

### ä¿®å¤å‰çš„ä»£ç é—®é¢˜
```python
@st.cache_data(ttl=300)  # è¿™é‡Œæœ‰é—®é¢˜
def get_stock_data(ticker_symbol):
    stock = yf.Ticker(ticker_symbol)  # Tickerå¯¹è±¡ä¸å¯åºåˆ—åŒ–
    # ... è·å–ä»·æ ¼é€»è¾‘
    return stock, current_price  # è¿”å›ä¸å¯åºåˆ—åŒ–çš„å¯¹è±¡
```

### ä¿®å¤åçš„ä»£ç 
```python
@st.cache_data(ttl=300)  # åªç¼“å­˜ä»·æ ¼æ•°æ®
def get_stock_price(ticker_symbol):
    """è·å–è‚¡ç¥¨å½“å‰ä»·æ ¼ï¼ˆå¯ç¼“å­˜ï¼‰"""
    stock = yf.Ticker(ticker_symbol)
    # ... è·å–ä»·æ ¼é€»è¾‘
    return float(current_price)  # åªè¿”å›å¯åºåˆ—åŒ–çš„æ•°æ®

def get_stock_data(ticker_symbol):
    """è·å–è‚¡ç¥¨æ•°æ®å’Œå½“å‰ä»·æ ¼"""
    # è·å–ç¼“å­˜çš„ä»·æ ¼
    current_price = get_stock_price(ticker_symbol)
    # åˆ›å»ºæ–°çš„è‚¡ç¥¨å¯¹è±¡ï¼ˆä¸ç¼“å­˜ï¼‰
    stock = yf.Ticker(ticker_symbol)
    return stock, current_price
```

## ä¿®å¤è¦ç‚¹

### 1. åˆ†ç¦»ç¼“å­˜é€»è¾‘
- **ç¼“å­˜å‡½æ•°**: åªç¼“å­˜å¯åºåˆ—åŒ–çš„æ•°æ®ï¼ˆä»·æ ¼ï¼‰
- **éç¼“å­˜å‡½æ•°**: å¤„ç†ä¸å¯åºåˆ—åŒ–çš„å¯¹è±¡ï¼ˆTickerï¼‰

### 2. æ•°æ®ç±»å‹å¤„ç†
- ç¡®ä¿ç¼“å­˜å‡½æ•°åªè¿”å›åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆint, float, str, list, dictï¼‰
- é¿å…ç¼“å­˜å¤æ‚å¯¹è±¡ï¼ˆç±»å®ä¾‹ã€å‡½æ•°ã€è¿æ¥å¯¹è±¡ç­‰ï¼‰

### 3. é”™è¯¯å¤„ç†å¢å¼º
- æ·»åŠ äº†æ›´å¤šçš„ try-catch å—
- æ”¹è¿›äº†é”™è¯¯æç¤ºä¿¡æ¯
- å¢åŠ äº†ç½‘ç»œé”™è¯¯çš„å¤„ç†

## å…¶ä»–æ”¹è¿›

### 1. æ€§èƒ½ä¼˜åŒ–
```python
# ç¼“å­˜è‚¡ç¥¨ä»·æ ¼5åˆ†é’Ÿ
@st.cache_data(ttl=300)
def get_stock_price(ticker_symbol):
    # å¤šç§æ–¹å¼è·å–ä»·æ ¼ï¼Œæé«˜æˆåŠŸç‡
    pass
```

### 2. é”™è¯¯å¤„ç†
```python
try:
    # ä¸»è¦é€»è¾‘
    pass
except Exception as e:
    st.error(f"å…·ä½“é”™è¯¯ä¿¡æ¯: {e}")
    st.info("ğŸ’¡ ç”¨æˆ·å‹å¥½çš„æç¤º")
```

### 3. å›¾è¡¨ç”Ÿæˆä¿æŠ¤
```python
try:
    # å›¾è¡¨ç”Ÿæˆä»£ç 
    st.plotly_chart(fig, use_container_width=True)
except Exception as e:
    st.info(f"å›¾è¡¨ç”Ÿæˆå¤±è´¥: {e}")
```

## å¸¸è§çš„ Streamlit ç¼“å­˜é”™è¯¯

### 1. UnserializableReturnValueError
- **åŸå› **: ç¼“å­˜å‡½æ•°è¿”å›ä¸å¯åºåˆ—åŒ–çš„å¯¹è±¡
- **è§£å†³**: åªç¼“å­˜åŸºæœ¬æ•°æ®ç±»å‹

### 2. UnhashableParamError
- **åŸå› **: ç¼“å­˜å‡½æ•°çš„å‚æ•°ä¸å¯å“ˆå¸Œ
- **è§£å†³**: ä½¿ç”¨å¯å“ˆå¸Œçš„å‚æ•°ç±»å‹

### 3. CachedObjectMutationError
- **åŸå› **: ä¿®æ”¹äº†ç¼“å­˜çš„å¯¹è±¡
- **è§£å†³**: ä½¿ç”¨ `.copy()` æˆ–è®¾ç½® `allow_output_mutation=True`

## éƒ¨ç½²éªŒè¯

ä¿®å¤åçš„åº”ç”¨å·²é€šè¿‡ä»¥ä¸‹æµ‹è¯•ï¼š
- âœ… æœ¬åœ°å¯¼å…¥æµ‹è¯•
- âœ… å‡½æ•°å­˜åœ¨æ€§æ£€æŸ¥
- âœ… è¯­æ³•é”™è¯¯æ£€æŸ¥
- âœ… Git ä»“åº“çŠ¶æ€æ£€æŸ¥

## éƒ¨ç½²æ­¥éª¤

1. **ä»£ç å·²æ¨é€åˆ° GitHub**
   ```bash
   git push
   ```

2. **åœ¨ Streamlit Cloud é‡æ–°éƒ¨ç½²**
   - è®¿é—®ä½ çš„åº”ç”¨ç®¡ç†é¡µé¢
   - ç‚¹å‡» "Reboot app" æˆ–ç­‰å¾…è‡ªåŠ¨é‡æ–°éƒ¨ç½²

3. **éªŒè¯ä¿®å¤**
   - æµ‹è¯•è‚¡ç¥¨æ•°æ®è·å–
   - éªŒè¯ç¼“å­˜åŠŸèƒ½
   - æ£€æŸ¥é”™è¯¯å¤„ç†

## é¢„é˜²æªæ–½

### 1. ç¼“å­˜æœ€ä½³å®è·µ
- åªç¼“å­˜çº¯æ•°æ®ï¼ˆæ•°å­—ã€å­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å­—å…¸ï¼‰
- é¿å…ç¼“å­˜å¯¹è±¡å®ä¾‹ã€è¿æ¥ã€æ–‡ä»¶å¥æŸ„
- ä½¿ç”¨é€‚å½“çš„ TTLï¼ˆç”Ÿå­˜æ—¶é—´ï¼‰

### 2. é”™è¯¯å¤„ç†
- ä¸ºæ‰€æœ‰å¤–éƒ¨ API è°ƒç”¨æ·»åŠ å¼‚å¸¸å¤„ç†
- æä¾›ç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯
- å®ç°ä¼˜é›…çš„é™çº§å¤„ç†

### 3. æµ‹è¯•ç­–ç•¥
- æœ¬åœ°æµ‹è¯•ç¼“å­˜åŠŸèƒ½
- éªŒè¯åºåˆ—åŒ–å…¼å®¹æ€§
- æµ‹è¯•ç½‘ç»œé”™è¯¯åœºæ™¯

---

**ä¿®å¤å®Œæˆï¼** ğŸ‰ åº”ç”¨ç°åœ¨åº”è¯¥å¯ä»¥åœ¨ Streamlit Cloud ä¸Šæ­£å¸¸è¿è¡Œäº†ã€‚